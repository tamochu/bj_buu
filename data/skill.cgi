my $risk = 0;
my $is_direct = 0;
#=================================================
# ‹Zİ’è Created by Merino
#=================================================
# ’Ç‰Á/íœ/•ÏX/•À‚Ñ‘Ö‚¦‰Â
@skills = (
	#[0]No,	[1]‹Z–¼,		[2]‘®«,[3]Á”ïMP,[4]ˆ—,	[5]¾ØÌ, [6]Ì×¸Ş, [7]‹­‚³
	[0,		'----',			'--',	0,		sub{},		'',sub{}, 5],

	[1,		'‚È‚¬•¥‚¢',		'Œ•',	7,		sub{ &_d( $_[0]*0.6 );								},	'',sub{ ${$who.'_is_stanch'} = 1; }, 14],
	[2,		'—¬¯Œ•',		'Œ•',	14,		sub{ 					&_d( $_[0]*1.5 );			},	'',sub{}, 20],
	[3,		'\•¶ša‚è',	'Œ•',	15,		sub{ 					&_d( $_[0]*rand(1)+0.7 );	},	'',sub{}, 20],
	[4,		'”na‚è',		'Œ•',	21,		sub{ $risk=$_[0]*0.1;	&_d( $_[0]*1.8 );			},	'',sub{}, 20],
	[5,		'”g“®Œ•',		'Œ•',	28,		sub{ $is_direct=1;		&_d( rand($_[0]) );			},	'',sub{}, 20],
	[6,		'¾•—Œ•',		'Œ•',	16,		sub{ $is_direct=1;		&_d( rand(60)+80 );			},	'•KE!¾•—Œ•!',sub{}, 20],
	[7,		'ŒŒõŒ•',		'Œ•',	10,		sub{ my $v=int(rand(50)+50); &_d( $v ); &_heal( $v );},	'Œ‚ÌŒõ‚æ‰ä‚É—Í‚ğ!ŒŒõŒ•!',sub{}, 10],
	[8,		'—´”ö•Ô‚µ',		'Œ•',	50,		sub{ $is_guard_s=1;									},	'',sub{ ${$who.'_is_guard'} = 1; }, 5],
 	[9,		'—‚êáŒ‰Ô',	'Œ•',	30,		sub{ 					&_d( 1.8, 'ag');			},	'•‘U‚ê!—‚êáŒ‰Ô!',sub{}, 20],
	[10,	'Œ•‘M',			'Œ•',	50,		sub{ 					&_d( $_[0]*2.0 );			},	'Œ•‚æ!‘S‚Ä‚Ì—Í‚ğŠJ•ú‚¹‚æ!Œ•‘M!',sub{}, 30],
    
	[11,	'‘«•¥‚¢',		'‘„',	8,		sub{ &_d( $_[0]*0.7 );								},	'',sub{ ${$who.'_is_stanch'} = 1; }, 14],
	[12,	'“ñ’i“Ë‚«',		'‘„',	9,		sub{ 					&_d( $_[0]*1.3 );			},	'',sub{}, 15],
	[13,	'Á¬°¼Ş',		'‘„',	30,		sub{ $is_direct=1;		&_d( rand($_[0]) );			},	'',sub{}, 20],
	[14,	'Î“Ë‚«',		'‘„',	15,		sub{ 					&_d( $_[0]*(rand(1.5)+0.1) );},	'',sub{}, 20],
	[15,	'´²Ğİ¸Ş',		'‘„',	65,		sub{ $is_guard_s=1;									},	'',sub{ ${$who.'_is_guard'} = 1; }, 5],
	[16,	'‘o—´”j',		'‘„',	28,		sub{ $is_direct=1;		&_d( rand(80)+140 );		},	'',sub{}, 20],
	[17,	'½¸Ø­°ÄŞ×²ÊŞ°',	'‘„',	35,		sub{ $risk=$_[0]*0.1;$is_direct=1;&_d( 0.4,'at' );	},'',sub{}, 20],
	[18,	'±ÙÃ¨Ò¯Ä±À¯¸',	'‘„',	60,		sub{ $risk=rand(100);	&_d( rand(2)*3,'ag');		},	'u‘¬!±ÙÃ¨Ò¯Ä±À¯¸!',sub{}, 20],
	[19,	'ŠˆEb_Õ',	'‘„',	99,		sub{ $is_direct=1;		&_d( $_[0]*(rand(0.5)+0.5) );},	'uE!ŠˆEb_Õ!',sub{}, 30],
	[20,	'–³‘oO’i',		'‘„',	50,		sub{ $risk=$_[0]*0.1;	&_d( $_[0]*2.2 );			},	'”é“`!–³‘oO’i!',sub{}, 20],

	[21,	'½¶Ù¸×¯¼­',		'•€',	9,		sub{ &_d( $_[0]*(rand(1)+0.4) );					},	'Ó‚¯U‚ê!½¶Ù¸×¯¼­!',sub{ ${$who.'_is_stanch'} = 1; }, 15],
	[22,	'Ò¶ŞÎ°¸',		'•€',	14,		sub{ 					&_d( 1.4, 'at' );			},	'',sub{}, 20],
	[23,	'Ê²Êß°ÊİÏ°',	'•€',	18,		sub{ $risk=$_[0]*0.1;	&_d( $_[0]*1.8 );			},	'',sub{}, 20],
	[24,	'±¸¾ÙÀ°İ',		'•€',	70,		sub{ $is_guard_s=1;		&_d( rand($_[0]*0.3) ); 	},	'',sub{ ${$who.'_is_guard'} = 1; }, 8],
	[25,	'ŸŒ³’f',		'•€',	25,		sub{ $is_direct=1;		&_d( rand(200)+50 );		},	'',sub{}, 20],
	[26,	'’@‚«—‚Æ‚µ',	'•€',	20,		sub{ &_d( $_[0]*1.5 );								},	'”]“V’¼Œ‚!’@‚«—‚Æ‚µ!',sub{ ${$who.'_is_stanch'} = 1; }, 20],
	[27,	'‰ñ“]a‚è',		'•€',	35,		sub{ $risk=$_[0]*0.15;	&_d( $_[0]*2.2 );			},	'',sub{}, 20],
	[28,	'ÃŞ¯ÄŞØ°½Ëßİ',	'•€',	55,		sub{ $risk=$_[0]*0.2;&_d( $_[0]*2.5 );				},	'•KE!ÃŞ¯ÄŞØ°½Ëßİ!',sub{ ${$who.'_is_stanch'} = 1; }, 20],
	[29,	'–‚la‚è',		'•€',	99,		sub{ 					&_d( $_[0]*int(rand(2))*3 );},	'‹°•|‚Æ‚¢‚¤–¼‚ğ‚»‚Ì‹¹‚É‚ß!–‚la‚è!',sub{}, 30],
	[30,	'b‰¤—ó•—a‚è',	'•€',	34,		sub{ &_d( 2.0, 'at' );								},	'šX‚ê!b‰¤—ó•—a‚è!',sub{ ${$who.'_is_stanch'} = 1; }, 20],

	[31,	'‰Š‚Ì–î',		'‰Š',	9,		sub{ 					&_d( $_[0]*1.3);			},	'',sub{}, 14],
	[32,	'¾ÙÌÊŞ°Æİ¸Ş',	'‰Š',	10,		sub{ 		&_mp_heal( 0.2, 'mdf' );				},	'',sub{}, -8],
	[33,	'‰Š‚ÌÀŞİ½',		'‰Š',	14,		sub{ 					&_d( 1.3, 'cha' );			},	'‰Š‚É•‘‚¦!',sub{}, 20],
	[34,	'Ì§²±³«°Ù',		'‰Š',	80,		sub{ $is_guard_s=1;								},	'',sub{ ${$who.'_is_guard'} = 1; }, 5],
	[35,	'–‚‰¤‚Ì‰Š',		'‰Š',	30,		sub{ $is_direct=1;	&_d( rand(0.5)+0.5, 'mat' );	},	'‘å’n‚Éõ‚İ“n‚é •œQ‚ÌÔ‚¢ŒŒ‚æ ‚»‚Ìg–½‚ğ‰Ê‚½‚¹I',sub{}, 20],
	[36,	'»İÌÚ²Ñ',		'‰Š',	38,		sub{ $risk=$_[0]*0.35;	&_d( $_[0]*2.5 );			},	'',sub{}, 20],
	[37,	'‰ŠE—ó”g',		'‰Š',	40,		sub{ $is_direct=1;&_d( rand(70)+160 );				},	'',sub{ ${$who.'_is_stanch'} = 1; }, 20],
	[38,	'’n–‚Ì‹Æ‰Î',	'‰Š',	45,		sub{ $risk=$_[0]*0.2;$is_direct=1;&_d( $_[0]*0.7 );	},	'’n–‚©‚ç¢Š«‚³‚ê‚µg˜@‚Ì‰Š!',sub{}, 20],
	[39,	'Ì¨Å°Ú',		'‰Š',	70,		sub{ $risk=$_[0]*0.2;$is_direct=1;&_d( rand($_[0])*3 );},	'Ià‚Ì¢ŠE‚Öc“™‚µ‚­–Å‚Ñ‚ğ—^‚¦‚ñ‚±‚Æ‚ğ!',sub{}, 30],
	[40,	'µ°ÊŞ°ÄŞ°½Ş',	'‰Š',	99,		sub{ $risk=$_[0]*0.3;$is_direct=1;&_d( rand(3)+1, 'mp' );},	'k‚¦‚ëA–½‚Â‚È‚¬~‚ß‚éŒõA¡‘S‚Ä‚ğ‰ğ‚«•ú‚ÄIµ°ÊŞ°ÄŞ°½Ş!',sub{}, 30],

	[41,	'³¨İÄŞÀŞ°Ä',	'•—',	5,		sub{ 					&_d( $_[0]*1.2 );			},	'',sub{}, 13],
	[42,	'–ü‚µ‚Ì•—',		'•—',	7,		sub{ 		&_heal( (rand(5)+1)*10 );				},	'',sub{}, -5],
	[43,	'’¾–Ù‚Ì•—',		'•—',	6,		sub{ 				&_mp_d( rand(30)+2 );			},	'’¾–Ù‚¹‚æ!',sub{}, 0],
	[44,	'»¸¼®İ',		'•—',	14,		sub{ $is_direct=1;		&_d( rand($_[0]*0.5)+20 );	},	'',sub{}, 20],
	[45,	'¶Ï²ÀÁÉÖÙ',		'•—',	18,		sub{ 					&_d( 1.4, 'ag' );			},	'Ø‚è—ô‚¯!',sub{}, 20],
	[46,	'ç‚è‚Ì•—',		'•—',	20,		sub{ &_d( 1.5, 'mdf' );								},	'',sub{ ${$who.'_is_counter'} = 1; }, 20],
	[47,	'Œ¶˜f‚Ì–¶',		'•—',	21,		sub{ 				&_mp_d( rand(0.7),'cha' );		},	'',sub{}, 20],
	[48,	'¼ÙÌ¨°ÄŞ',		'•—',	16,		sub{ 												},	'',sub{ ${$who.'_is_counter'} = 1; }, 5],
	[49,	'“Vg‚Ì‰H',		'•—',	40,		sub{ $is_direct=1;&_d( rand($_[0]) );&_heal( rand($_[0]*0.3) );},'¡“ğ‚Ì–¼‚É‚¨‚¢‚ÄAâq‚ê‚µÒ‚ğò‰»‚¹‚æ!',sub{}, 10],
	[50,	'–²Œ¶‘o—•‘',	'•—',	50,		sub{ $is_direct=1; my $v=rand(0.5)+0.5; &_d( $v,'cha' );&_heal( $v*0.5,'cha' );},'‚»‚Ì–½!‰ä‚Ì—Æ‚Æ‚È‚ê!–²Œ¶‘o—•‘!',sub{}, 30],

	[51,	'¸Û½»İÀŞ°',		'—‹',	4,		sub{ 					&_d( $_[0]*(rand(1)+0.5) ); },	'',sub{}, 12],
	[52,	'—‹‚Ìô”›',		'—‹',	8,		sub{ &_mp_d( rand($_[0]*0.3) );						},	'',sub{ ${$who.'_is_stanch'} = 1; }, 14],
	[53,	'Ï¼Ş¯¸½Ã¨°Ù',	'—‹',	90,		sub{ $is_guard_s=1; my $v=rand(30); &_mp_d( $v ); &_mp_heal( $v*0.8 );	},	'',sub{ ${$who.'_is_guard'} = 1; }, -5],
	[54,	'ˆîÈa‚è',		'—‹',	10,		sub{ 					&_d( $_[0]*1.3 );			},	'',sub{}, 15],
	[55,	'ºŞ¯ÄŞÊİÄŞ',	'—‹',	15,		sub{ &_d( 1.5, 'mat' );								},	'–‚‚Ì—‚ğ”w•‰‚¢AŒõ‚Æ‚È‚è‚ÄW‚¦!',sub{ ${$who.'_is_stanch'} = 1; }, 20],
	[56,	'²ËŞÙ»İÀŞ°',	'—‹',	29,		sub{ $risk=$_[0]*0.1;	&_d( 1.8, 'cha' );			},	'',sub{}, 20],
	[57,	'»İÀŞ°ÌŞÚ²¸',	'—‹',	40,		sub{ $is_direct=1;&_d( rand($_[0])+10 );			},'ŠÑ‚¯!»İÀŞ°ÌŞÚ²¸!',sub{ ${$who.'_is_stanch'} = 1; }, 20],
	[58,	'ç’¹',			'—‹',	34,		sub{ 					&_d( 1.8, 'ag' );			},	'',sub{}, 20],
	[59,	'Œ‚ÌÙ‚«',		'—‹',	30,		sub{ $is_direct=1;		&_d( rand(150)+80 );		},	'‚±‚ÌÒ‚ğ”±‚¹‚æ!Œ‚ÌÙ‚«!',sub{}, 20],
	[60,	'—´—‹_',		'—‹',	60,		sub{ &_d( $_[0]*2.0 );								},	'“V‚æ‚è•‘‚¢~‚è‚µ—‹‚Ì—´‚æ!',sub{ ${$who.'_is_stanch'} = 1; }, 30],

	[61,	'¸Ş×İÄŞ¸Û½',	'–³',	20,		sub{ &_d( 1.4, 'df');								},	'•KE!¸Ş×İÄŞ¸Û½!',sub{ ${$who.'_is_counter'} = 1; }, 20],
	[62,	'ÊßÌÊßÌ',		'–³',	15,		sub{ my $v=rand(0.3); &_mp_d( $v,'cha' ); &_mp_heal( $v*0.5,'cha' );	},	'™Ê§Ä™',sub{}, -5],
	[63,	'”š—óŒ',		'–³',	30,		sub{ 					&_d( rand($_[0]*3) );		},	'‚­‚ç‚¦!”šE—óEŒ!',sub{}, 20],
	[64,	'‹ó‹C“Š‚°',		'–³',	45,		sub{ $is_direct=1;&_d( 0.3, 'hp' );					},	'',sub{ ${$who.'_is_stanch'} = 1; }, 20],
	[65,	'¼Ş¬²±İÄ½²İ¸Ş',	'–³',	35,		sub{ &_d( $_[0]*(rand(1)+1) );						},	'',sub{ ${$who.'_is_stanch'} = 1; }, 20],
	[66,	'“¬‹C',			'–³',	40,		sub{ 		&_heal( 0.15, 'max_hp' );				},	'',sub{}, -5],
	[67,	'¸Û½¶³İÀ°',		'–³',	60,		sub{ $is_guard_s=1;								},	'',sub{ ${$who.'_is_guard'} = 1; }, 5],
	[68,	'Ñ°İ»ÙÄ',		'–³',	48,		sub{ $is_direct=1;		&_d( rand(0.7)+0.3, 'cha' );},	'',sub{}, 20],
	[69,	'—¬¯R‚è',		'–³',	54,		sub{ 					&_d( rand(1)+1.5, 'ag' );	},	'•KE!—¬¯R‚è!',sub{}, 30],
	[70,	'—´_—ó‰ÎŒ',	'–³',	99,		sub{ $is_direct=1;		&_d( $_[0]*(rand(1)+0.2) ); },	'g‚Ì‚‚È‚é‚ÍS‚Ì‚‚Æ‚È‚ç‚´‚é‚È‚è!–û’f‘å“G!—´_—ó‰ÎŒ!',sub{}, 30],
);

# ------------------
sub _d {
	my($v, $k) = @_;
	
	if ($who eq 'm') {
		$v = $v * $m{$k} if defined $k;
		$v = $v * 0.5 - $y_df * 0.3 unless $is_direct;
		$v = $v < 0 ? int( rand(5) ) : int( $v * (rand(0.3)+ 0.9) );
		$y{hp} -= $v;
		$mes .= "$y{name} ‚É $v ‚ÌÀŞÒ°¼Ş‚ğ‚ ‚½‚¦‚½!<br>";
	}
	elsif ($who eq 'y') {
		$v = $v * $y{$k} if defined $k;
		$v = $v * 0.5 - $m_df * 0.3 unless $is_direct;
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$m{hp} -= $v;
		$mes .= "$m{name} ‚Í $v ‚ÌÀŞÒ°¼Ş‚ğ‚¤‚¯‚½!<br>";
	}
	&_risk($risk) if $risk;
	$is_direct = 0;
}

# ------------------
# ”½“®ÀŞÒ°¼Ş
sub _risk {
	my $v = shift;

	if ($who eq 'm' && !($guas[$m{gua}][0] eq '18' && rand(10) < 3)) {
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$m{hp} -= $v;
		$mes .= "$m{name} ‚Í ‹Z‚Ì”½“®‚Å $v ‚ÌÀŞÒ°¼Ş‚ğ‚¤‚¯‚½!<br>";
	}
	elsif ($who eq 'y' && !($guas[$y{gua}][0] eq '18' && rand(10) < 3)) {
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$y{hp} -= $v;
		$mes .= "$y{name} ‚Í ‹Z‚Ì”½“®‚Å $v ‚ÌÀŞÒ°¼Ş‚ğ‚¤‚¯‚½!<br>";
	}
	$risk = 0;
}

# ------------------
# HP‰ñ•œ
sub _heal {
	my($v, $k) = @_;

	if ($who eq 'm') {
		$v = $v * $m{$k} if defined $k;
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$m{hp} += $v;
		$m{hp} = $m{max_hp} if $m{hp} > $m{max_hp};
		$mes .= "$m{name} ‚Ì $e2j{hp} ‚ª $v ‰ñ•œ‚µ‚Ü‚µ‚½<br>";
	}
	elsif ($who eq 'y') {
		$v = $v * $y{$k} if defined $k;
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$y{hp} += $v;
		$y{hp} = $y{max_hp} if $y{hp} > $y{max_hp};
		$mes .= "$y{name} ‚Ì $e2j{hp} ‚ª $v ‰ñ•œ‚µ‚Ü‚µ‚½<br>";
	}
}

# ------------------
# MP‰ñ•œ
sub _mp_heal {
	my($v, $k) = @_;

	if ($who eq 'm') {
		$v = $v * $m{$k} if defined $k;
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$m{mp} += $v;
		$m{mp} = $m{max_mp} if $m{mp} > $m{max_mp};
		$mes .= "$m{name} ‚Ì $e2j{mp} ‚ª $v ‰ñ•œ‚µ‚Ü‚µ‚½<br>";
	}
	elsif ($who eq 'y') {
		$v = $v * $y{$k} if defined $k;
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$y{mp} += $v;
		$y{mp} = $y{max_mp} if $y{mp} > $y{max_mp};
		$mes .= "$y{name} ‚Ì $e2j{mp} ‚ª $v ‰ñ•œ‚µ‚Ü‚µ‚½<br>";
	}
}

# ------------------
# MP‚ÉÀŞÒ°¼Ş
sub _mp_d {
	my($v, $k) = @_;

	if ($who eq 'm') {
		$v = $v * $m{$k} if defined $k;
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$y{mp} -= $v;
		$y{mp} = 0 if $y{mp} < 0;
		$mes .= "$y{name} ‚Ì$e2j{mp}‚É $v ‚ÌÀŞÒ°¼Ş‚ğ‚ ‚½‚¦‚½!<br>";
	}
	elsif ($who eq 'y') {
		$v = $v * $y{$k} if defined $k;
		$v = $v < 0 ? int( rand(5)+1 ) : int( $v * (rand(0.3)+ 0.9) );
		$m{mp} -= $v;
		$m{mp} = 0 if $m{mp} < 0;
		$mes .= "$m{name} ‚Ì$e2j{mp}‚É $v ‚ÌÀŞÒ°¼Ş‚ğ‚¤‚¯‚½!<br>";
	}
}


1; # íœ•s‰Â
